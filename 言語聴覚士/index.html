<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Communication Assistant</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header class="app-header">
        <div class="header-left">
            <div class="heart-icon">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                </svg>
            </div>
            <h1>Comboard</h1>
        </div>
        <div class="header-right">
            <button id="sos-btn" class="icon-button sos-header-btn" aria-label="緊急連絡">
                🚨 SOS
            </button>
            <button id="keyboard-btn" class="icon-button" aria-label="キーボード入力">
                ⌨️ 入力
            </button>
            <button id="draw-btn" class="icon-button" aria-label="筆談ボード">
                ✏️ 筆談
            </button>
            <button id="help-btn" class="icon-button" aria-label="ヘルプカード">
                🪪 My Card
            </button>
        </div>
    </header>

    <section id="news-section" class="news-container">
        <div class="news-header">
            <h3>📢 センターからのお知らせ</h3>
        </div>
        <div class="news-content" id="news-ticker">
            <p>読み込み中...</p>
        </div>
    </section>

    <main id="board-container" class="board-grid">
        <!-- Buttons will be generated by JavaScript -->
    </main>

    <footer class="app-footer">
        <p>Tap to speak / タップして発話</p>
    </footer>

    <!-- Help Card Modal -->
    <div id="help-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>🪪 デジタルヘルプカード</h2>
                <button id="close-modal" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Display Mode -->
                <div id="card-display">
                    <div class="help-card-view">
                        <div class="card-header-badge">
                            <span class="medical-icon">🏥</span> 救急・支援情報カード
                        </div>
                        <div class="card-body-content">
                            <div class="card-row name-row">
                                <div class="label-icon">👤</div>
                                <div class="name-container">
                                    <span class="label">氏名</span>
                                    <span class="value name-value" id="disp-name">未設定</span>
                                </div>
                            </div>
                            <div class="card-row info-row">
                                <div class="info-item">
                                    <span class="label">🎂 年齢</span>
                                    <span class="value" id="disp-age">--</span>
                                </div>
                                <div class="info-item">
                                    <span class="label">🩸 血液型</span>
                                    <span class="value" id="disp-blood">--</span>
                                </div>
                            </div>
                            <hr class="card-divider">
                            <div class="card-section">
                                <span class="label-title">⚠️ 私について（病気・障害など）</span>
                                <div class="value box-value" id="disp-condition">
                                    <p>情報の登録がありません。</p>
                                </div>
                            </div>
                            <div class="card-section">
                                <span class="label-title">📞 緊急連絡先</span>
                                <div class="value box-value" id="disp-emergency">
                                    <p>--</p>
                                </div>
                            </div>
                            <div class="card-section">
                                <span class="label-title">🏥 かかりつけ医・病院</span>
                                <div class="value box-value" id="disp-hospital">
                                    <p>--</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button id="edit-btn" class="primary-button full-width">📝 情報を編集する</button>
                </div>

                <!-- Edit Mode -->
                <div id="card-edit" class="hidden">
                    <form id="help-card-form">
                        <div class="form-group">
                            <label for="input-name">氏名</label>
                            <input type="text" id="input-name" placeholder="例: 広島 太郎">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="input-age">年齢</label>
                                <input type="text" id="input-age" placeholder="例: 70歳">
                            </div>
                            <div class="form-group">
                                <label for="input-blood">血液型</label>
                                <input type="text" id="input-blood" placeholder="例: A型">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="input-condition">私について (伝えたいこと)</label>
                            <textarea id="input-condition" rows="3"
                                placeholder="例: 失語症があります。ゆっくり話してください。ペースメーカーを入れています。"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="input-emergency">緊急連絡先 (家族など)</label>
                            <textarea id="input-emergency" rows="2" placeholder="例: 妻・花子 090-XXXX-XXXX"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="input-hospital">かかりつけ医・病院</label>
                            <textarea id="input-hospital" rows="2"
                                placeholder="例: 〇〇病院 脳神経内科 (082-XXX-XXXX)"></textarea>
                        </div>
                        <div class="button-group">
                            <button type="button" id="cancel-edit" class="secondary-button">キャンセル</button>
                            <button type="submit" class="primary-button">保存する</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Phrase Modal -->
    <div id="add-phrase-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>✨ 言葉を追加する</h2>
                <button id="close-add-modal" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-phrase-form">
                    <div class="form-group">
                        <label for="new-phrase-label">ボタンの名前</label>
                        <input type="text" id="new-phrase-label" placeholder="例: ポチ" required>
                    </div>
                    <div class="form-group">
                        <label for="new-phrase-text">話す言葉</label>
                        <input type="text" id="new-phrase-text" placeholder="例: ポチにご飯をあげてください" required>
                    </div>
                    <div class="form-group">
                        <label>アイコンを選ぶ</label>
                        <div class="icon-selection">
                            <button type="button" class="icon-option selected" data-icon="🗣️">🗣️</button>
                            <button type="button" class="icon-option" data-icon="🐶">🐶</button>
                            <button type="button" class="icon-option" data-icon="🐱">🐱</button>
                            <button type="button" class="icon-option" data-icon="🍚">🍚</button>
                            <button type="button" class="icon-option" data-icon="💊">💊</button>
                            <button type="button" class="icon-option" data-icon="👓">👓</button>
                            <button type="button" class="icon-option" data-icon="📺">📺</button>
                            <button type="button" class="icon-option" data-icon="🚽">🚽</button>
                            <button type="button" class="icon-option" data-icon="🙏">🙏</button>
                            <button type="button" class="icon-option" data-icon="❤️">❤️</button>
                        </div>
                        <input type="hidden" id="new-phrase-icon" value="🗣️">
                    </div>
                    <div class="button-group">
                        <button type="button" id="cancel-add-btn" class="secondary-button">キャンセル</button>
                        <button type="submit" class="primary-button">追加する</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Whiteboard Modal -->
    <div id="draw-modal" class="modal hidden">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>✏️ 筆談ボード</h2>
                <button id="close-draw-modal" class="close-button">&times;</button>
            </div>
            <div class="modal-body no-scroll">
                <div class="canvas-controls">
                    <div class="color-picker">
                        <button class="color-btn active" data-color="#000000" style="background:black;"></button>
                        <button class="color-btn" data-color="#ff0000" style="background:red;"></button>
                        <button class="color-btn" data-color="#0000ff" style="background:blue;"></button>
                    </div>
                    <div class="width-picker">
                        <button class="width-btn active" data-width="2">細</button>
                        <button class="width-btn" data-width="5">中</button>
                        <button class="width-btn" data-width="10">太</button>
                    </div>
                    <div class="action-buttons">
                        <button id="clear-canvas" class="secondary-button">全消去</button>
                    </div>
                </div>
                <div class="canvas-container">
                    <canvas id="drawing-canvas"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Keyboard Input Modal -->
    <div id="keyboard-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>⌨️ 自由入力</h2>
                <button id="close-keyboard-modal" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <div class="keyboard-container">
                    <textarea id="keyboard-input" rows="4" placeholder="話したい言葉を入力してください..."></textarea>
                    <div class="button-group">
                        <button id="clear-keyboard" class="secondary-button">クリア</button>
                        <button id="speak-keyboard-btn" class="primary-button">
                            🗣️ 話す
                        </button>
                    </div>
                </div>

                <div class="quick-phrases">
                    <h3>履歴 / 定型文</h3>
                    <div id="quick-history" class="history-list">
                        <!-- History items will go here -->
                        <p class="empty-history">履歴はありません</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SOS Modal -->
    <div id="sos-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header emergency-header">
                <h2>🚨 緊急連絡</h2>
                <button id="close-sos-modal" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <p class="sos-instruction">緊急連絡先を選択してください。<br>ボタンを押すと電話をかけます。</p>
                <div id="sos-buttons-container" class="sos-buttons-grid">
                    <!-- Buttons will be injected here -->
                    <a href="tel:119" class="sos-button ambulance">
                        <span class="sos-icon">🚑</span>
                        <span class="sos-label">救急車 (119)</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="news_data.js"></script>
    <script src="app.js"></script>
</body>

</html>